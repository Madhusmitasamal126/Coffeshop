{% extends "base.html" %}
{% block title %}Payment{% endblock %}

{% block content %}
<div style="max-width:500px; margin:60px auto; padding:30px; background:#fff; border-radius:15px; box-shadow:0 8px 25px rgba(0,0,0,0.1); text-align:center;">
    
    <h1 style="color:#ff6f61; margin-bottom:20px;">Pay for Order #{{ order.id }}</h1>
    
    <p style="font-size:1.2em; margin-bottom:30px;">Amount to Pay: <span style="font-weight:700; color:#28a745;">â‚¹{{ amount }}</span></p>
    
    <button id="rzp-button" style="padding:15px 30px; font-size:1em; color:#fff; background:#ff6f61; border:none; border-radius:10px; cursor:pointer; transition:0.3s;">
        Pay Online
    </button>

    <p style="margin-top:20px; font-size:0.9em; color:#666;">Secure payment powered by Razorpay</p>

    <a href="{% url 'order_page' %}?item_id={{ order.item.id }}&qty={{ order.quantity }}" style="display:inline-block; margin-top:20px; color:#ff6f61; text-decoration:underline;">Back to Order</a>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
    "key": "{{ razorpay_key }}",
    "amount": "{{ amount|floatformat:2 }}00", // convert to paise
    "currency": "{{ currency }}",
    "name": "Our Cafe",
    "description": "Order #{{ order.id }} Payment",
    "order_id": "{{ razorpay_order_id }}",
    "theme": { "color": "#ff6f61" },
    "handler": function(response){
        window.location.href = "/payment-success/{{ order.id }}/";
    },
};
var rzp1 = new Razorpay(options);
document.getElementById('rzp-button').onclick = function(e){
    rzp1.open();
    e.preventDefault();
}
</script>
{% endblock %}
