{% extends "base.html" %}
{% block title %}Payment{% endblock %}

{% block content %}
<div class="container my-5" style="max-width:550px;">
    <div class="card shadow-lg border-0 rounded-4 p-5 text-center">

        <!-- Payment Heading -->
        <h1 class="fw-bold mb-3 text-coffee">ðŸ’³ Complete Payment</h1>
        <p class="text-muted mb-4">Order ID: <strong>#{{ order.id }}</strong></p>

        <!-- Amount Section -->
        <div class="border rounded-4 p-4 mb-4 bg-light">
            <h4 class="mb-0">Amount to Pay</h4>
            <p class="fw-bold text-success fs-3 mb-0">â‚¹{{ amount }}</p>
        </div>

        <!-- Pay Button -->
        <button id="rzp-button" 
            class="btn btn-lg btn-coffee px-5 py-3 fw-bold shadow-sm rounded-3 mb-3">
            ðŸš€ Pay Online Securely
        </button>

        <p class="small text-muted">ðŸ”’ Secure payment powered by <span class="fw-bold">Razorpay</span></p>

        <!-- Back Button -->
        <div class="mt-4">
            <a href="{% url 'order_page' %}?item_id={{ order.item.id }}&qty={{ order.quantity }}" 
               class="btn btn-outline-coffee rounded-3 px-4 py-2">
               â¬… Back to Order
            </a>
        </div>
    </div>
</div>

<!-- Razorpay Integration -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
    "key": "{{ razorpay_key }}",
    "amount": "{{ amount|floatformat:2 }}00", // paise
    "currency": "{{ currency }}",
    "name": "Our Cafe",
    "description": "Order #{{ order.id }} Payment",
    "order_id": "{{ razorpay_order_id }}",
    "theme": { "color": "#ff6f61" },
    "handler": function(response){
        window.location.href = "/payment-success/{{ order.id }}/";
    },
};
var rzp1 = new Razorpay(options);
document.getElementById('rzp-button').onclick = function(e){
    rzp1.open();
    e.preventDefault();
}
</script>
{% endblock %}

{% block extra_scripts %}
<style>
:root {
    --coffee-dark: #4B2E2B;
    --coffee-light: #ff6f61;
}
.text-coffee { color: var(--coffee-dark); }

.btn-coffee {
    background: var(--coffee-light);
    color: #fff;
    border-radius: 12px;
    transition: 0.3s;
}
.btn-coffee:hover {
    background: #e65348;
    transform: translateY(-2px);
}

.btn-outline-coffee {
    border: 2px solid var(--coffee-dark);
    color: var(--coffee-dark);
    transition: 0.3s;
}
.btn-outline-coffee:hover {
    background: var(--coffee-dark);
    color: #fff;
}
</style>
{% endblock %}
