{% extends "base.html" %}
{% load static %}

{% block content %}
<h1>üçΩ Our Menu</h1>
<p>Explore our delicious food & beverages</p>

{% for category in categories %}
<section class="category-section" style="margin-bottom:40px;">
    <h2>{{ category.name }}</h2>
    <div class="menu-grid" style="display:flex; flex-wrap:wrap; gap:20px; margin-top:10px;">
        {% for item in category.items.all %}
        <div id="item-{{ item.id }}" class="card" style="border:1px solid #ddd; padding:15px; border-radius:8px; width:200px; text-align:center;">
            {% if item.image %}
            <img src="{{ item.image.url }}" alt="{{ item.name }}" style="width:100%; height:150px; object-fit:cover; border-radius:6px;">
            {% endif %}
            <h3>{{ item.name }}</h3>
            <p>‚Çπ{{ item.price }}</p>
            <input type="number" class="qty-input" value="1" min="1" style="width:50px;">
            <button class="order-btn" style="margin-top:5px; padding:5px 10px;">Order</button>
        </div>
        {% endfor %}
    </div>
</section>
{% endfor %}

<script>
document.addEventListener("DOMContentLoaded", () => {
    // Scroll to highlighted item
    const highlighted = document.getElementById("item-{{ highlighted_item_id }}");
    if (highlighted) {
        highlighted.scrollIntoView({ behavior: "smooth", block: "center" });
        highlighted.style.backgroundColor = "#fff7e6";
    }

    // Make order buttons redirect to order page
    document.querySelectorAll(".order-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
            const card = e.target.closest(".card");
            const itemId = card.id.split('-')[1];
            const qty = card.querySelector(".qty-input").value || 1;
            window.location.href = `/order/?item_id=${itemId}&qty=${qty}`;
        });
    });
});
</script>
{% endblock %}
